{{! Template to generate SQL with enhanced GPL v3 license and tag data }}
{{{sql_license}}}

-- =============================================================================
-- Data Quality Slovaris Tags
-- =============================================================================

\echo '--- Data Quality Slovaris Tags ---'

{{#tags}}
select ores_dq_tags_upsert_fn(
    '{{dataset_name}}',
    '{{subject_area_name}}',
    '{{domain_name}}',
    '{{tag_name}}',
    '{{tag_description}}'
);
{{/tags}}

-- =============================================================================
-- Summary
-- =============================================================================

\echo ''
\echo '--- Summary ---'

select 'ores_dq_datasets' as entity, count(*) as count
from ores_dq_datasets_tbl
where valid_to = ores_utility_infinity_timestamp_fn()
union all
select 'ores_dq_tags_artefact', count(*)
from ores_dq_tags_artefact_tbl;
