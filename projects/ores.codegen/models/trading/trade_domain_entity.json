{
  "domain_entity": {
    "schema": "public",
    "component": "trading",
    "entity_singular": "trade",
    "entity_plural": "trades",
    "entity_title": "Trade",
    "has_tenant_id": true,
    "generator_facet_name": "generator",
    "brief": "Trade capturing FpML Trade Header properties.",
    "description": "Temporal trade record. Each lifecycle event (New, Amendment, Novation,\netc.) creates a new temporal row for the same trade id. The internal party\nis derived from book_id via books.party_id.",

    "primary_key": {
      "column": "id",
      "type": "uuid",
      "cpp_type": "boost::uuids::uuid",
      "description": "UUID uniquely identifying this trade.",
      "detail": "Surrogate key for the trade record."
    },

    "columns": [
      {
        "name": "external_id",
        "type": "text",
        "cpp_type": "std::string",
        "nullable": true,
        "description": "Optional external trade identifier.",
        "detail": "e.g., UTI prefix or legacy system ID.",
        "generator_expr": "std::string()"
      },
      {
        "name": "book_id",
        "type": "uuid",
        "cpp_type": "boost::uuids::uuid",
        "nullable": false,
        "description": "Book that owns this trade.",
        "detail": "Soft FK to ores_refdata_books_tbl.",
        "generator_expr": "ctx.generate_uuid()"
      },
      {
        "name": "portfolio_id",
        "type": "uuid",
        "cpp_type": "boost::uuids::uuid",
        "nullable": false,
        "description": "Portfolio this trade belongs to.",
        "detail": "Soft FK to ores_refdata_portfolios_tbl.",
        "generator_expr": "ctx.generate_uuid()"
      },
      {
        "name": "successor_trade_id",
        "type": "uuid",
        "cpp_type": "std::optional<boost::uuids::uuid>",
        "nullable": true,
        "description": "UUID of the trade that replaced this one (e.g., after novation).",
        "detail": "Self-referencing soft FK. Absent for active trades.",
        "generator_expr": "std::nullopt"
      },
      {
        "name": "trade_type",
        "type": "text",
        "cpp_type": "std::string",
        "nullable": false,
        "description": "ORE instrument type code (e.g. Swap, FxForward, CapFloor).",
        "detail": "Soft FK to ores_trading_trade_types_tbl.",
        "generator_expr": "std::string(\"Swap\")"
      },
      {
        "name": "netting_set_id",
        "type": "text",
        "cpp_type": "std::string",
        "nullable": false,
        "description": "Netting set identifier for ORE aggregation.",
        "detail": "Groups trades under the same netting agreement.",
        "generator_expr": "std::string(\"NS-001\")"
      },
      {
        "name": "lifecycle_event",
        "type": "text",
        "cpp_type": "std::string",
        "nullable": false,
        "description": "Lifecycle event type (e.g. New, Amendment, Novation, Termination).",
        "detail": "Soft FK to ores_trading_lifecycle_events_tbl.",
        "generator_expr": "std::string(\"New\")"
      },
      {
        "name": "trade_date",
        "type": "date",
        "cpp_type": "std::string",
        "nullable": false,
        "description": "Date the trade was agreed.",
        "detail": "ISO 8601 date: YYYY-MM-DD.",
        "generator_expr": "std::string(\"2025-01-15\")"
      },
      {
        "name": "execution_timestamp",
        "type": "text",
        "cpp_type": "std::string",
        "nullable": false,
        "description": "Timestamp when the trade was executed (with timezone).",
        "detail": "ISO 8601 timestamp: YYYY-MM-DD HH:MM:SS+TZ.",
        "generator_expr": "std::string(\"2025-01-15 10:00:00\")"
      },
      {
        "name": "effective_date",
        "type": "date",
        "cpp_type": "std::string",
        "nullable": false,
        "description": "Date from which the trade is effective.",
        "detail": "ISO 8601 date: YYYY-MM-DD.",
        "generator_expr": "std::string(\"2025-01-16\")"
      },
      {
        "name": "termination_date",
        "type": "date",
        "cpp_type": "std::string",
        "nullable": false,
        "description": "Date on which the trade matures or terminates.",
        "detail": "ISO 8601 date: YYYY-MM-DD.",
        "generator_expr": "std::string(\"2026-01-15\")"
      }
    ],

    "sql": {
      "tablename": "ores_trading_trades_tbl"
    },

    "repository": {
      "entity_singular_short": "trade",
      "entity_plural_short": "trades",
      "entity_singular_words": "trade",
      "entity_plural_words": "trades"
    },

    "cpp": {
      "includes": {
        "domain": ["<chrono>", "<optional>", "<string>", "<boost/uuid/uuid.hpp>"]
      },
      "iterator_var": "tr"
    },

    "qt": {
      "domain_include": "ores.trading/domain/trade.hpp",
      "domain_class": "trading::domain::trade",
      "protocol_include": "ores.trading/messaging/trade_protocol.hpp",
      "collection_name": "trades",
      "item_var": "trade",
      "key_field": "external_id",
      "has_uuid_primary_key": true,
      "get_request_class": "trading::messaging::get_trades_request",
      "get_response_class": "trading::messaging::get_trades_response",
      "get_message_type": "get_trades_request",
      "save_request_class": "trading::messaging::save_trade_request",
      "save_response_class": "trading::messaging::save_trade_response",
      "save_message_type": "save_trade_request",
      "save_request_item_field": "trade",
      "delete_request_class": "trading::messaging::delete_trade_request",
      "delete_response_class": "trading::messaging::delete_trade_response",
      "delete_message_type": "delete_trade_request",
      "history_request_class": "trading::messaging::get_trade_history_request",
      "history_response_class": "trading::messaging::get_trade_history_response",
      "history_message_type": "get_trade_history_request",
      "detail_fields": [
        {"field": "external_id", "label": "External ID", "widget": "externalIdEdit", "type": "line_edit", "is_key": true, "placeholder": "Enter external trade ID (e.g., UTI)"},
        {"field": "trade_type", "label": "Trade Type", "widget": "tradeTypeEdit", "type": "line_edit", "is_required": true, "placeholder": "e.g., Swap, FxForward"},
        {"field": "lifecycle_event", "label": "Lifecycle Event", "widget": "lifecycleEventEdit", "type": "line_edit", "is_required": true, "placeholder": "e.g., New, Amendment"},
        {"field": "netting_set_id", "label": "Netting Set", "widget": "nettingSetIdEdit", "type": "line_edit", "placeholder": "e.g., NS-001"},
        {"field": "trade_date", "label": "Trade Date", "widget": "tradeDateEdit", "type": "line_edit", "is_required": true, "placeholder": "YYYY-MM-DD"},
        {"field": "effective_date", "label": "Effective Date", "widget": "effectiveDateEdit", "type": "line_edit", "is_required": true, "placeholder": "YYYY-MM-DD"},
        {"field": "termination_date", "label": "Termination Date", "widget": "terminationDateEdit", "type": "line_edit", "is_required": true, "placeholder": "YYYY-MM-DD"},
        {"field": "execution_timestamp", "label": "Execution Timestamp", "widget": "executionTimestampEdit", "type": "line_edit", "placeholder": "YYYY-MM-DD HH:MM:SS"}
      ],
      "columns": [
        {"enum_name": "ExternalId", "field": "external_id", "header": "External ID", "is_string": true, "width": 180},
        {"enum_name": "TradeType", "field": "trade_type", "header": "Type", "is_string": true, "width": 120},
        {"enum_name": "LifecycleEvent", "field": "lifecycle_event", "header": "Event", "is_string": true, "width": 120},
        {"enum_name": "TradeDate", "field": "trade_date", "header": "Trade Date", "is_string": true, "width": 110},
        {"enum_name": "EffectiveDate", "field": "effective_date", "header": "Effective", "is_string": true, "width": 110},
        {"enum_name": "TerminationDate", "field": "termination_date", "header": "Termination", "is_string": true, "width": 110},
        {"enum_name": "NettingSetId", "field": "netting_set_id", "header": "Netting Set", "is_string": true, "width": 120},
        {"enum_name": "Version", "field": "version", "header": "Version", "is_int": true, "width": 80},
        {"enum_name": "ModifiedBy", "field": "modified_by", "header": "Modified By", "is_string": true, "width": 120},
        {"enum_name": "RecordedAt", "field": "recorded_at", "header": "Recorded At", "is_timestamp": true, "width": 150}
      ],
      "settings_group": "TradeListWindow",
      "window_title": "Trades",
      "icon": "DocumentTable",
      "has_pagination": true
    }
  }
}
