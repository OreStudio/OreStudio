:PROPERTIES:
:ID: 5A85BDB5-E915-3A44-04AB-771ACE91992B
:END:
#+title: Sprint Backlog 04
#+options: <:nil c:nil ^:nil d:nil date:nil author:nil toc:nil html-postamble:nil
#+todo: STARTED | COMPLETED CANCELLED POSTPONED BLOCKED
#+tags: { code(c) infra(i) analysis(n) agile(a) }
#+startup: inlineimages

* Sprint Mission

- implement bootstrap mode.
- add system navigator and login.
- add crud for accounts and currency.

* Stories

** Active

#+begin: clocktable :maxlevel 3 :scope subtree :tags t :indent nil :emphasize nil :scope file :narrow 75 :formula % :block today
#+TBLNAME: today_summary
#+CAPTION: Clock summary at [2025-11-08 Sat 10:11], for Saturday, November 08, 2025.
|       | <75>                                  |        |      |      |       |
| Tags  | Headline                              | Time   |      |      |     % |
|-------+---------------------------------------+--------+------+------+-------|
|       | *Total time*                          | *2:48* |      |      | 100.0 |
|-------+---------------------------------------+--------+------+------+-------|
|       | Stories                               | 2:48   |      |      | 100.0 |
|       | Active                                |        | 2:48 |      | 100.0 |
| agile | Sprint and product backlog refinement |        |      | 0:09 |   5.4 |
| code  | Use fluent icons                      |        |      | 0:27 |  16.1 |
| code  | Add currency editing support          |        |      | 0:58 |  34.5 |
| code  | Make UI/UX look more professional     |        |      | 1:14 |  44.0 |
#+end:

#+begin: clocktable :maxlevel 3 :scope subtree :tags t :indent nil :emphasize nil :scope file :narrow 75 :formula %
#+TBLNAME: sprint_summary
#+CAPTION: Clock summary at [2025-11-08 Sat 10:11]
|       | <75>                                                   |         |       |      |       |
| Tags  | Headline                                               | Time    |       |      |     % |
|-------+--------------------------------------------------------+---------+-------+------+-------|
|       | *Total time*                                           | *10:23* |       |      | 100.0 |
|-------+--------------------------------------------------------+---------+-------+------+-------|
|       | Stories                                                | 10:23   |       |      | 100.0 |
|       | Active                                                 |         | 10:23 |      | 100.0 |
| agile | Sprint and product backlog refinement                  |         |       | 0:43 |   6.9 |
| code  | Clean up client parser                                 |         |       | 0:10 |   1.6 |
| code  | Add connect command line argument                      |         |       | 1:19 |  12.7 |
| infra | Install Windows package on Windows machine             |         |       | 2:09 |  20.7 |
| code  | Ignore warnings on windows and osx                     |         |       | 0:33 |   5.3 |
| code  | Ensure applications work under OSX using github images |         |       | 0:14 |   2.2 |
| infra | Create a splash screen and gray background             |         |       | 2:26 |  23.4 |
| code  | Use fluent icons                                       |         |       | 0:37 |   5.9 |
| code  | Add currency editing support                           |         |       | 0:58 |   9.3 |
| code  | Make UI/UX look more professional                      |         |       | 1:14 |  11.9 |
#+end:

*** STARTED Sprint and product backlog refinement                     :agile:
    :LOGBOOK:
    CLOCK: [2025-11-08 Sat 01:27]--[2025-11-08 Sat 01:36] =>  0:09
    CLOCK: [2025-11-07 Fri 10:35]--[2025-11-07 Fri 10:47] =>  0:12
    CLOCK: [2025-11-07 Fri 09:05]--[2025-11-07 Fri 09:13] =>  0:08
    CLOCK: [2025-11-07 Fri 08:50]--[2025-11-07 Fri 09:04] =>  0:14
    :END:

Updates to sprint and product backlog.

#+begin_src emacs-lisp :exports none
;; agenda
(org-agenda-file-to-front)
#+end_src

#+name: stories-chart
#+begin_src R :var sprint_summary=sprint_summary :results file graphics :exports results :file sprint_backlog_04_stories.png :width 1200 :height 650
library(conflicted)
library(grid)
library(tidyverse)
library(tibble)

# Remove unnecessary rows.
clean_sprint_summary <- tail(sprint_summary, -4)
names <- unlist(clean_sprint_summary[2])
values <- as.numeric(unlist(clean_sprint_summary[6]))

# Create a data frame.
df <- data.frame(
  cost = values,
  stories = factor(names, levels = names[order(values, decreasing = FALSE)]),
  y = seq(length(names)) * 0.9
)

# Setup the colors
blue <- "#076fa2"

p <- ggplot(df) +
  aes(x = cost, y = stories) +
  geom_col(fill = blue, width = 0.6) +
  ggtitle("Sprint 1: Resourcing per Story") +
  xlab("Resourcing (%)") + ylab("Stories") +
  theme(text = element_text(size = 15))

print(p)
#+end_src

#+RESULTS: stories-chart
[[file:sprint_backlog_04_stories.png]]

#+name: tags-chart
#+begin_src R :var sprint_summary=sprint_summary :results file graphics :exports results :file sprint_backlog_04_tags.png :width 600 :height 400
library(conflicted)
library(grid)
library(tidyverse)
library(tibble)

# Remove unnecessary rows.
clean_sprint_summary <- tail(sprint_summary, -4)
names <- unlist(clean_sprint_summary[1])
values <- as.numeric(unlist(clean_sprint_summary[6]))

# Create a data frame.
df <- data.frame(
  cost = values,
  tags = names,
  y = seq(length(names)) * 0.9
)
# factor(names, levels = names[order(values, decreasing = FALSE)])

df2 <- setNames(aggregate(df$cost, by = list(df$tags), FUN = sum),  c("cost", "tags"))
# Setup the colors
blue <- "#076fa2"

p <- ggplot(df2) +
  aes(x = cost, y = tags) +
  geom_col(fill = blue, width = 0.6) +
  ggtitle("Sprint 1: Resourcing per Tag") +
  xlab("Resourcing (%)") + ylab("Story types") +
  theme(text = element_text(size = 15))

print(p)
#+end_src

#+RESULTS: tags-chart
[[file:sprint_backlog_04_tags.png]]

*** COMPLETED CTest shows only one test per test suite                 :code:

We need to be able to see individual tests and the reasons for their failures.

Notes:

- raised an issue with CMake.

Links:

- [[https://gitlab.kitware.com/cmake/cmake/-/issues/27363][#27363: CTest: Uploading generated JUnit XML from the test harness]]
- [[https://public.kitware.com/pipermail/cdash/2015-February/001544.html][[Cdash] How to send a JUnit result file to CDash server with CTest?]]

*** COMPLETED Clean up client parser                                   :code:
    :LOGBOOK:
    CLOCK: [2025-11-07 Fri 09:14]--[2025-11-07 Fri 09:24] =>  0:10
    :END:

It should use common infrastructure and read variables from the environment.

*** COMPLETED Add connect command line argument                        :code:
    :LOGBOOK:
    CLOCK: [2025-11-07 Fri 11:56]--[2025-11-07 Fri 13:15] =>  1:19
    :END:

To avoid leaking secrets it should be possible to supply a =--connect= in the
client. We still need a connect in case we want to reconnect.

Notes:

- clean up parser in client, not using common logging.
- add environment mapping to client.

Links:

- [[https://github.com/daniele77/cli/issues/250][#250: Basic Scripting with Cli]]

*** COMPLETED Install Windows package on Windows machine              :infra:
    :LOGBOOK:
    CLOCK: [2025-11-07 Fri 14:51]--[2025-11-07 Fri 16:28] =>  1:37
    CLOCK: [2025-11-07 Fri 11:33]--[2025-11-07 Fri 11:55] =>  0:22
    CLOCK: [2025-11-07 Fri 10:48]--[2025-11-07 Fri 10:58] =>  0:10
    :END:

We need to install and run the windows package and make sure it works. Check
console and GUI start. Also, check we can connect against local service and
against remove service.

Notes:

- application fails to start because QT6 DLLs are not in bin folder. It is also
  missing libssl. Adding vcpkg to presets copied a lot of the DLLs:

#+begin_src json
{
  "version": 3,
  "configurePresets": [
    {
      "name": "default",
      "generator": "Visual Studio 17 2022",
      "architecture": "x64",
      "toolchainFile": "$env{VCPKG_ROOT}/scripts/buildsystems/vcpkg.cmake",
      "binaryDir": "build",
      "cacheVariables": {
        "X_VCPKG_APPLOCAL_DEPS_INSTALL": true
      }
    }
  ]
}
#+end_src

- services are now running and connecting to postgres. Managed to connect from
  Linux to Windows and log in. However, Qt UI won't start due to missing DLLs.
  Installed Qt from online downloader, need to figure out what is missing. Open
  a separate story to handle Qt issues.

Links:

- [[https://github.com/microsoft/vcpkg/issues/43066][#43066: X_VCPKG_APPLOCAL_DEPS_INSTALL requires dumpbin to be on PATH for windows]]
- [[https://stackoverflow.com/questions/68579934/how-to-copy-targets-all-runtime-dependencies-after-build-process-in-cmake][How to copy target's all runtime dependencies after build process in CMake?]]
- [[https://stackoverflow.com/questions/78723493/cmake-install-rules][CMake install rules]]

*** BLOCKED Ignore warnings on windows and osx                         :code:
    :LOGBOOK:
    CLOCK: [2025-11-07 Fri 10:59]--[2025-11-07 Fri 11:32] =>  0:33
    :END:

At present we have a number of spurious warnings on both windows and OSX. Try to
see if we can get CDash to ignore them.

Notes:

- Raised a Kitware ticket.

Links:

- [[https://gitlab.kitware.com/cmake/cmake/-/issues/27367][CTest: Using regexes to filter warnings for CDash]]
- [[https://stackoverflow.com/questions/26458652/ctest-custom-warning-exception][SO: ctest custom warning exception]]

*** BLOCKED Ensure applications work under OSX using github images     :code:
    :LOGBOOK:
    CLOCK: [2025-11-07 Fri 16:29]--[2025-11-07 Fri 16:43] =>  0:14
    :END:

We need to install the DMG and run the app.

We think the package does not have all of the dependencies, but this did not
work:

#+begin_src cmake
if(APPLE)
    install(CODE "
        # make sure the bundle is already on disk
        set(BU_CHMOD_BUNDLE_ITEMS TRUE)
        include(BundleUtilities)

        # full path to the real executable inside the bundle
        set(app_exe \"\${CMAKE_INSTALL_PREFIX}/OreStudio.app/Contents/MacOS/OreStudio\")

        # directory where 3rd-party libraries will be copied
        set(libs_dir \"\${CMAKE_INSTALL_PREFIX}/OreStudio.app/Contents/Frameworks\")

        # discover all prerequisites and copy/fix them
        fixup_bundle(\"\${app_exe}\" \"\" \"\${libs_dir}\")
    " COMPONENT Runtime)
endif()
#+end_src

We should ask someone with an OSX machine to test this.

Links:

- [[https://stackoverflow.com/questions/17974439/cant-use-fixup-bundle-to-create-a-portable-bundle-with-qt][SO: Can't use fixup_bundle() to create a portable bundle with Qt]]

*** COMPLETED Create a splash screen and gray background              :infra:
    :LOGBOOK:
    CLOCK: [2025-11-07 Fri 23:30]--[2025-11-07 Fri 23:49] =>  0:19
    CLOCK: [2025-11-07 Fri 17:54]--[2025-11-07 Fri 18:57] =>  1:03
    CLOCK: [2025-11-07 Fri 16:49]--[2025-11-07 Fri 17:53] =>  1:04
    :END:

We need to replace the basic splash with something that looks slightly better.
We also need some kind of background for the initial screen when nothing is
selected, a bit like visual studio code.

*** COMPLETED Use fluent icons                                         :code:
    :LOGBOOK:
    CLOCK: [2025-11-07 Fri 23:50]--[2025-11-08 Sat 00:27] =>  0:37
    :END:

These seem to be a bit better than the current icons we have:

- [[https://github.com/microsoft/fluentui-system-icons/tree/main][fluentui-system-icons]]

*** STARTED Add currency editing support                               :code:
    :LOGBOOK:
    CLOCK: [2025-11-08 Sat 00:28]--[2025-11-08 Sat 01:26] =>  0:58
    :END:

We need to be able to open up individual currencies and edit them. We also need
to be able to select multiple currencies and delete them.

Notes:

- add toolbar for crud operations. Not clear how we know what they apply to.
  Ideally you select multiple currencies and then press delete.
- separate the connection part of the toolbar from ref data and from crud.
- add a version string to the splash screen.
- valid to in edit dialog is still equal to valid from.
- create a history dialog showing the history of changes including modified by.
- add flags for the currencies. Need database support. Display them in the
  currencies dialog.

*** STARTED Make UI/UX look more professional                          :code:
    :LOGBOOK:
    CLOCK: [2025-11-08 Sat 10:11]
    CLOCK: [2025-11-08 Sat 08:57]--[2025-11-08 Sat 10:11] =>  1:14
    :END:

Analysis from Gemini:

#+begin_src markdown
To make your Qt application look like an advanced trading system—even for a
simple CRUD operation screen—requires moving beyond basic desktop application
styles toward the dense, high-contrast, data-rich aesthetic of platforms like
Bloomberg or professional broker terminals.

The current look (a dark table with simple data rows) is a great foundation.
Here are targeted suggestions for your Qt UI to elevate it to a professional,
advanced trading system aesthetic:

## I. Color and Contrast (The Dark Theme)

Your current dark gray background is good, but trading systems use specific
contrast to highlight data significance.

1.  **Define a Palette:** Adopt a limited, functional color palette:

      ,* **Primary Background:** A very dark, near-black charcoal (`#1A1A1A` or
        `#1E1E1E`). This is the foundation.
      ,* **Foreground/Text:** Clean white or light gray (`#F0F0F0`).
      ,* **Accent Color (Neutral):** A subdued corporate blue/cyan (`#007ACC` or
        a subtle green/gold from your branding) for selected rows, borders, and
        input focus.
      ,* **Data Status Colors:**
          ,* **Positive (Gains):** Bright, high-contrast green (`#00C853`).
          ,* **Negative (Losses):** High-contrast red (`#FF3333`).
          ,* *(While CRUD isn't about gains/losses, you can use these colors for
            status, like 'Active' vs. 'Inactive' currencies).*

2.  **Subtle Depth:** Avoid flat black. Use a slightly lighter shade of gray
    (`#2A2A2A`) for embedded panels, sidebars, and control areas to create
    visual segmentation, giving the impression of modularity.

## II. Typography and Data Presentation

Trading UIs prioritize density and scannability.

1.  **Monospace Font:** For the currency codes and numerical columns, switch to
    a clear, legible **monospace font** (like Consolas, Fira Code, or a custom
    font in Qt). Monospace fonts ensure that all numbers align perfectly in
    columns, which is essential for rapid data comparison.
2.  **Font Sizing:** Use a small, consistent font size (e.g., 10pt or 11pt) to
    fit more data on screen. Use bolding sparingly, primarily for the Currency
    Code (e.g., USD, EUR).
3.  **Visual Alignment:**
      ,* **Text Columns** (Currency Name): Left-aligned.
      ,* **Code Columns** (ISO Code, Symbol): Center-aligned.
      ,* **Numerical Columns** (Rounding, Precision): Right-aligned. **This is
        critical** for financial UIs, as it allows users to compare magnitude
        instantly.

## III. Advanced Table View Enhancements (QTableView/QTableWidget)

Since the core of this screen is a table, focus on making the table look
high-tech.

1.  **Header Styling:**

      ,* Make column headers slightly stand out with a subtle dark gradient or a
        distinct, slightly brighter background color (e.g., `#282828`).
      ,* Ensure the header font is crisp (perhaps slightly bolder than the row
        data).
      ,* Add tiny, clear **sort indicators** to show the current sort direction.

2.  **Row Selection:**

      ,* The selected row should use your accent color (e.g., a thin blue left
        border or a light blue background fill) with white or light gray text
        for high visibility.
      ,* Introduce **subtle, faint horizontal rules** (1px in a color like
        `#333333`) to separate rows, which aids readability in dense tables.

3.  **Interactive Elements (Hover):** Implement a very subtle change on row
    hover (e.g., the background darkens by 5%) to indicate interactivity, even
    if clicking doesn't change the view.

## IV. UI Layout and Modularity

Advanced UIs are rarely monolithic; they are built from modular panels.

1.  **Toolbar (Top):** Create a clean, dedicated toolbar area at the top for
    your CRUD operations (`Add`, `Edit`, `Delete`) and your system icons
    (Connection, Reference Data).

      ,* Use the Fluent UI System Icons you researched (`globe-32-regular`,
        `money-32-regular`).
      ,* Buttons should be flat, high-contrast text or icons only. On hover, they
        should reveal a subtle gray background or a thin accent border.

2.  **Side Panel (Right or Left):** Instead of a simple dialog for *editing*,
    use a dedicated side panel that slides out or appears next to the table when
    a row is selected.

      ,* This panel would house the detail view for the selected currency. This
        makes the UI feel like a single workspace rather than navigating modal
        windows.
      ,* Give this panel a slightly different background shade (`#2A2A2A`).

3.  **Status Bar (Bottom):** Add a sleek, minimal status bar at the bottom. This
    is where you would place your connection status icon (using your proposed
    `globe-32-regular` or `plug-connected-32-regular` icon). It reinforces the
    "system is live" feel.

## V. Qt-Specific Implementation via Stylesheets

In Qt, you achieve this professional look primarily through **QSS (Qt Style
Sheets)**. You will be targeting specific widgets (like `QTableView`,
`QPushButton`, `QLineEdit`) with CSS-like rules.

```css
/* Example QSS Snippets for the Trading Look */

QTableView {
    /* Base style for the data area */
    background-color: #1A1A1A; /* Primary Background */
    gridline-color: #333333; /* Faint row separators */
    color: #F0F0F0;
    border: 1px solid #007ACC; /* Subtle border using accent color */
    selection-background-color: #007ACC; /* Accent Color for selection */
    selection-color: white;
}

QHeaderView::section {
    /* Style for Column Headers */
    background-color: #282828; /* Slightly lighter shade for headers */
    color: #FFFFFF;
    border: none;
    padding: 6px;
    font-size: 11pt;
    font-weight: bold;
}

QLineEdit {
    /* Style for input fields (e.g., in the side panel or search) */
    background-color: #1A1A1A;
    border: 1px solid #444444;
    color: #F0F0F0;
    padding: 5px;
}

QPushButton {
    /* Flat button style for toolbar */
    background-color: transparent;
    border: none;
    color: #F0F0F0;
    padding: 8px 12px;
}

QPushButton:hover {
    /* Hover effect */
    background-color: #2A2A2A;
    border: 1px solid #007ACC;
}
```
#+end_src

*** Add about to menu                                                  :code:

We need an about describing the project.

*** Update readme with UI screenshots                                  :code:

Now that we have a basic UI up and running, add it to docs.

*** Add country support                                                :code:

We will probably need country support at some point. We should link the country
to the currencies, where applicable.

*** Repl needs synchronous socket operations                           :code:

At present the operations on sockets are async. This is a problem with the repl
because we issue commands out of order. For example this causes scripting to
fail.

- [[https://github.com/daniele77/cli/discussions/251][#251: Basic Scripting with Cli]]

*** Setup Qt properly on Windows                                       :code:

Seems like our package is still missing Qt DLLs. Use the windows tool to
determine what is missing. Consider installing Qt in the build machine via the
built packages.

*** Server must check database connectivity on startup                 :code:

At present the server only checks connectivity to database when a user requests
an operation. We need some kind of initial polling which puts the server in a
mode replying to all clients: "database not available". While this is happening,
it should keep polling the database and checking the connectivity.

*** Add SC script on windows to install ores.service                   :code:

We should package a trivial batch file that sets up the service on windows. We
should also consider adding a simple script to setup the service on Linux.
Ideally it should be done via the packaging step.

*** Package SQL scripts                                                :code:

We need to initialise the database on installation. The package should contain
all of the necessary SQL as well as a script to do it.

*** Resolve all of the OpenSSL leaks in valgrind                       :code:

We are freeing up open SSL memory and still have leaks. For now just apply the
suppression suggestions and deal with this later.

*** Add support for feature flags                                      :code:

We need a way to know if we are in bootstrap mode or not. Implement a generic
mechanism for feature flags.

Example chrome flag:

#+begin_quote
Temporarily unexpire M139 flags.

Temporarily unexpire flags that expired as of M139. These flags will be removed
soon. – Mac, Windows, Linux, ChromeOS, Android

#temporary-unexpire-flags-m139
#+end_quote

Components:

- name: human readable
- description
- id

*** Implement authentication bootstrap workflow                        :code:

Notes:

- when there are no accounts setup, the repl should say to the user that it
  needs to create an admin account.
- first account must be admin.
- once there is an account we need to make sure the user is logged in before we
  process most message types.

Mongo message:

#+begin_src logview
2020-06-09T13:26:51.391+0000 I  CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2020-06-09T13:26:51.391+0000 I  CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
#+end_src

Requirements:

#+begin_src markdown
# Authentication Bootstrapping Requirements

## R1: Initial System State (Bootstrap Mode)

The system **MUST** start in a special **"Bootstrap Mode"** where the only
permitted action is the creation of the initial Administrator account.

## R2: Access Control in Bootstrap Mode

While the system is in Bootstrap Mode:

- **R2.1: Allowed Endpoint:** The service **MUST** only expose and accept
  requests for a single endpoint: `POST /api/v1/accounts/create-admin` (or
  equivalent).
- **R2.2: Local-Only Restriction:** All requests to the allowed endpoint
  ,**MUST** originate from a **trusted local interface** (e.g., `127.0.0.1` or
  the server's designated internal IP range). Requests from any external/public
  IP address **MUST** be rejected.
- **R2.3: General Endpoint Rejection:** All other API endpoints (e.g., login,
  user creation, data access) **MUST** immediately return a $\mathbf{403}$
  ,**Forbidden** or $\mathbf{401}$ **Unauthorized** status, along with a clear
  message indicating the system is in setup mode.

## R3: Initial Admin Account Creation

The first account created through the allowed endpoint **MUST** adhere to the
following:

- **R3.1: Mandatory Admin Role:** The account **MUST** be assigned the highest
  level of **Administrator privileges** (`is_admin: true`).
- **R3.2: Strong Password Policy:** The request **MUST** be validated against a
  strong password policy (e.g., minimum 12 characters, requiring a mix of case,
  numbers, and symbols). Failure to meet this standard **MUST** result in a
  $\mathbf{400}$ **Bad Request** error.
- **R3.3: One-Time Execution:** The administrator creation process **MUST** only
  be allowed to succeed **exactly once**.

## R4: System State Transition

Upon successful creation of the first Administrator account (R3):

- **R4.1: State Change:** The system **MUST** immediately and atomically
  transition from **"Bootstrap Mode"** to **"Secure Mode"**. This state change
  ,**MUST** be persisted.
- **R4.2: Bootstrap Endpoint Deactivation:** The `POST
  /api/v1/accounts/create-admin` endpoint **MUST** be permanently disabled. Any
  subsequent request to this endpoint **MUST** return a $\mathbf{403}$
  ,**Forbidden** error.

## R5: Secure Mode Operation

Once the system is in **"Secure Mode"**:

- **R5.1: General Access Control:** All operational API endpoints **MUST** now
  enforce **full authentication and authorization**.
- **R5.2: Mandatory Login:** All users, including the newly created
  Administrator, **MUST** successfully complete a login process to obtain a
  valid session token before accessing any resource.
- **R5.3: Standard Account Creation:** The standard non-admin account creation
  endpoint (`POST /api/v1/accounts/create`) **MUST** become available, subject
  to any configured access controls (e.g., only open to logged-in Admins, or
  fully public).
#+end_src

Links:

- [[https://www.digitalocean.com/community/tutorials/how-to-secure-mongodb-on-ubuntu-20-04][How To Secure MongoDB on Ubuntu 20.04]]

*** Remove postgres passwords from github workflows                    :code:

As a quick hack we added the dev passwords to the workflows. We should really
generate these on the fly and supply them to the tests.

*** Allow supplying the postgres connection URI                        :code:

At present we are supplying all of the components for the connection. It may be
easier to allow the entire URI:

- connection-uri: The connection URI to connect to PostgreSQL. Example:
  =postgresql://postgres:postgres@localhost/postgres=.

*** Consider adding log command line options to qt                     :code:

At present we have hard-coded logging options. However, maybe users should be
able to change the logging settings from the UI rather than having to restart
the app and supply command line options.

*** Investigate valgrind leak on sqlgen                                :code:

Is this a real leak:

#+begin_src valgrind-leak
==2599359==
==2599359== HEAP SUMMARY:
==2599359==     in use at exit: 11,421 bytes in 78 blocks
==2599359==   total heap usage: 403,744 allocs, 403,666 frees, 161,473,513 bytes allocated
==2599359==
==2599359== 1,944 bytes in 9 blocks are definitely lost in loss record 20 of 21
==2599359==    at 0x4F2B818: malloc (vg_replace_malloc.c:446)
==2599359==    by 0x5AE29FF: PQmakeEmptyPGresult (fe-exec.c:161)
==2599359==    by 0x5AEA9F2: pqParseInput3 (fe-protocol3.c:264)
==2599359==    by 0x5AE5853: parseInput (fe-exec.c:1997)
==2599359==    by 0x5AE5975: PQgetResult (fe-exec.c:2083)
==2599359==    by 0x5AE5FB7: PQexecFinish (fe-exec.c:2388)
==2599359==    by 0x5AE5D98: PQprepare (fe-exec.c:2275)
==2599359==    by 0x5A7F688: sqlgen::postgres::Connection::insert(sqlgen::dynamic::Insert const&, std::vector<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, std::allocator<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > > > const&) (Connection.cpp:44)
==2599359==    by 0x525189F: sqlgen::Session<sqlgen::postgres::Connection>::insert(sqlgen::dynamic::Insert const&, std::vector<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, std::allocator<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > > > const&) (Session.hpp:50)
==2599359==    by 0x523F4FF: sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> >::insert(sqlgen::dynamic::Insert const&, std::vector<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, std::allocator<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > > > const&) (Transaction.hpp:61)
==2599359==    by 0x523EE20: rfl::Result<rfl::Ref<sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > > > sqlgen::insert_impl<__gnu_cxx::__normal_iterator<ores::accounts::repository::account_entity const*, std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> > >, __gnu_cxx::__normal_iterator<ores::accounts::repository::account_entity const*, std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> > >, sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > >(rfl::Ref<sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > > const&, __gnu_cxx::__normal_iterator<ores::accounts::repository::account_entity const*, std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> > >, __gnu_cxx::__normal_iterator<ores::accounts::repository::account_entity const*, std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> > >, bool) requires is_connection<sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > > (insert.hpp:46)
==2599359==    by 0x523EB55: auto sqlgen::insert_impl<std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> >, rfl::Ref<sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > > >(rfl::Ref<sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > > const&, std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> > const&, bool) (insert.hpp:69)
==2599359==
==2599359== 3,672 bytes in 17 blocks are definitely lost in loss record 21 of 21
==2599359==    at 0x4F2B818: malloc (vg_replace_malloc.c:446)
==2599359==    by 0x5AE29FF: PQmakeEmptyPGresult (fe-exec.c:161)
==2599359==    by 0x5AEA78E: pqParseInput3 (fe-protocol3.c:200)
==2599359==    by 0x5AE5853: parseInput (fe-exec.c:1997)
==2599359==    by 0x5AE5975: PQgetResult (fe-exec.c:2083)
==2599359==    by 0x5AE5FB7: PQexecFinish (fe-exec.c:2388)
==2599359==    by 0x5AE5E15: PQexecPrepared (fe-exec.c:2298)
==2599359==    by 0x5A7FB5B: sqlgen::postgres::Connection::insert(sqlgen::dynamic::Insert const&, std::vector<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, std::allocator<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > > > const&) (Connection.cpp:72)
==2599359==    by 0x525189F: sqlgen::Session<sqlgen::postgres::Connection>::insert(sqlgen::dynamic::Insert const&, std::vector<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, std::allocator<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > > > const&) (Session.hpp:50)
==2599359==    by 0x523F4FF: sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> >::insert(sqlgen::dynamic::Insert const&, std::vector<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, std::allocator<std::vector<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::optional<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > > > const&) (Transaction.hpp:61)
==2599359==    by 0x523EE20: rfl::Result<rfl::Ref<sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > > > sqlgen::insert_impl<__gnu_cxx::__normal_iterator<ores::accounts::repository::account_entity const*, std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> > >, __gnu_cxx::__normal_iterator<ores::accounts::repository::account_entity const*, std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> > >, sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > >(rfl::Ref<sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > > const&, __gnu_cxx::__normal_iterator<ores::accounts::repository::account_entity const*, std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> > >, __gnu_cxx::__normal_iterator<ores::accounts::repository::account_entity const*, std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> > >, bool) requires is_connection<sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > > (insert.hpp:46)
==2599359==    by 0x523EB55: auto sqlgen::insert_impl<std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> >, rfl::Ref<sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > > >(rfl::Ref<sqlgen::Transaction<sqlgen::Session<sqlgen::postgres::Connection> > > const&, std::vector<ores::accounts::repository::account_entity, std::allocator<ores::accounts::repository::account_entity> > const&, bool) (insert.hpp:69)
==2599359==
==2599359== LEAK SUMMARY:
==2599359==    definitely lost: 5,616 bytes in 26 blocks
==2599359==    indirectly lost: 0 bytes in 0 blocks
==2599359==      possibly lost: 0 bytes in 0 blocks
==2599359==    still reachable: 5,805 bytes in 52 blocks
==2599359==         suppressed: 0 bytes in 0 blocks
==2599359== Reachable blocks (those to which a pointer was found) are not shown.
==2599359== To see them, rerun with: --leak-check=full --show-leak-kinds=all
==2599359==
==2599359== For lists of detected and suppressed errors, rerun with: -s
==2599359== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0)
#+end_src



*** Footer

| Previous: [[id:154212FF-BB02-8D84-1E33-9338B458380A][Version Zero]] |
