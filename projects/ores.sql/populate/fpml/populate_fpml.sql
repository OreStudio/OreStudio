/* -*- sql-product: postgres; tab-width: 4; indent-tabs-mode: nil -*-
 *
 * FPML Reference Data Master Include File
 *
 * Auto-generated by generate_fpml_refdata.sh
 * Includes all FPML SQL files in the correct dependency order.
 */

-- =============================================================================
-- FpML Standards Catalog (must come first)
-- =============================================================================

\echo '--- FpML Standards Catalog ---'
\ir fpml_catalog_populate.sql

-- =============================================================================
-- FPML Methodology
-- =============================================================================

\echo '--- FPML Methodology ---'
\ir fpml_methodology_populate.sql

-- =============================================================================
-- FPML Coding Schemes Dataset (must come first - other datasets reference these schemes)
-- =============================================================================

\echo '--- FPML Coding Schemes Dataset ---'
\ir fpml_coding_schemes_dataset_populate.sql

-- =============================================================================
-- FPML Coding Schemes Artefacts
-- =============================================================================

\echo '--- FPML Coding Schemes Artefacts ---'
\ir fpml_coding_schemes_artefact_populate.sql

-- Publish coding schemes to production (required before other datasets can reference them)
\echo '--- Publishing FPML Coding Schemes ---'
select * from metadata.dq_populate_coding_schemes(
    (select id from metadata.dq_datasets_tbl where code = 'fpml.coding_schemes' and valid_to = public.utility_infinity_timestamp_fn()),
    'upsert'
);

-- =============================================================================
-- FPML Datasets (depend on coding schemes being published)
-- =============================================================================

\echo '--- FPML Datasets ---'
\ir fpml_non_iso_currency_dataset_populate.sql

-- =============================================================================
-- FPML Dataset Dependencies
-- =============================================================================

\echo '--- FPML Dataset Dependencies ---'
\ir fpml_dataset_dependency_populate.sql

-- =============================================================================
-- FPML Artefacts
-- =============================================================================

\echo '--- FPML Artefacts ---'
\ir fpml_non_iso_currency_artefact_populate.sql
