{{! Template to generate SQL dataset entry for FPML reference data }}
{{{sql_license}}}

/**
 * {{dataset.name}} Dataset Population Script
 *
 * Creates the dataset entry for {{dataset.code}}.
 * Source version: {{dataset.source_version}}
 * This must be run before populating the artefact table.
 */

-- =============================================================================
-- {{dataset.name}} Dataset
-- =============================================================================

\echo '--- {{dataset.name}} Dataset ---'

select ores_dq_datasets_upsert_fn(ores_iam_system_tenant_id_fn(),
    '{{dataset.code}}',
    'FpML Standards',
    '{{entity.subject_area}}',
    'Reference Data',
    '{{dataset.coding_scheme_code}}',
    'Primary',
    'Actual',
    'Raw',
    'FpML Genericode Download',
    '{{dataset.name}}',
    '{{dataset.description}}',
    'FPML',
    'Reference data for {{dataset.name}} (version {{dataset.source_version}})',
    {{#dataset.publication_date}}'{{dataset.publication_date}}'::date{{/dataset.publication_date}}{{^dataset.publication_date}}current_date{{/dataset.publication_date}},
    'FpML Public License 2.0',
    {{#shared_table_config}}'{{shared_table_config.artefact_type}}'{{/shared_table_config}}{{^shared_table_config}}'{{entity.entity_plural}}'{{/shared_table_config}}
);
